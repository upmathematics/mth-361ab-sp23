---
title: 'Introduction to Data <span style="color:blue">Solutions</span>'
author: "Alex John Quijano"
date: "`r Sys.Date()`"
output: openintro::lab_report
---

```{r load-packages, message=FALSE, warning=FALSE, paged.print=FALSE}
library(tidyverse)
library(openintro)
```

### Exercise 1

```{r histogram-1, message=FALSE, warning=FALSE}
ggplot(data = nycflights, aes(x = dep_delay)) +
  geom_histogram()
```

```{r histogram-2}
ggplot(data = nycflights, aes(x = dep_delay)) +
  geom_histogram(binwidth = 15)
```

```{r histogram-3}
ggplot(data = nycflights, aes(x = dep_delay)) +
  geom_histogram(binwidth = 150)
```

The three histograms show different types of resolution depending on the binwidth. Wider binwidth shows that details of the histogram are obscured while narrower binwidth shows more detail. While all three histograms show an extremely right skewed distribution, the narrower binwidth - which is shown in the second histogram - shows more details on the left side of the distribution.

### Exercise 2

```{r feb-flights}
sfo_feb_flights_new <- nycflights %>%
  filter(dest == "SFO", month == 2)

dim(sfo_feb_flights_new)
```

There are $68$ flights meet these criteria

### Exercise 3

```{r feb-flights-histogram}
ggplot(data = sfo_feb_flights_new, aes(x = arr_delay)) +
  geom_histogram(binwidth = 15)
```

```{r feb-flights-summary-stats}
summary(sfo_feb_flights_new$arr_delay)
```

The histogram of the arrival delays shows a right skewed distribution with mode close to $0$ in the negative side. Since the distribution showed extreme outliers and it is right skewed, the quartiles should be used as an appropriate summary statistics. The median delay time is $-11$ minutes and the first and 3rd quartiles are $-21.25$ minutes and $-4.50$ minutes. This means that that $50$\% of the flights arrived in SFO $4.50$ to $21.25$ minutes early.

### Exercise 4

```{r feb-flights-iqr}
sfo_feb_flights_new %>%
  group_by(carrier) %>%
  summarise(median_dd = median(arr_delay), 
            iqr_dd = IQR(arr_delay), 
            n_flights = n())
```

The IQR measures the extent of variability in the data. Since the carrier DL and UA (Delta and United Airlines) has the highest IQR, then these two airlines has the most variability among the carriers.

### Exercise 5

```{r mean-and-median-month}
nycflights %>%
  group_by(month) %>%
  summarise(mean_dd = mean(dep_delay),
            median_dd = median(dep_delay)) %>%
  arrange(median_dd)
```

Both mean and median are measures of center in a distribution. However, the median is more robust than the mean because it is not sensitive to outliers. The summary statistics indicate that the departure delays distributions are all skewed right since the mean is much higher than the median. This means extreme departure delays are likely outliers. One would choose the lowest median departure delay because that is the center where most of the data points are located. So, choosing the months $9$ or $10$ (September or October) - with medians of $-3$ minutes - seems to be the best options because it indicates early departures since it's negative. If choosing the mean, it appears to be that October has the lowest mean departure delay of $5.88$ minutes.

### Exercise 6

```{r flights-departure-rates}
nycflights <- nycflights %>%
  mutate(dep_type = ifelse(dep_delay < 5, "on time", "delayed"))

nycflights %>%
  group_by(origin) %>%
  summarise(ot_dep_rate = sum(dep_type == "on time") / n()) %>%
  arrange(desc(ot_dep_rate))
```

```{r flights-departure-rates-barplot}
ggplot(data = nycflights, aes(x = origin, fill = dep_type)) +
  geom_bar(position="fill")
```

Based on the percentages, LGA airport has the most on time departures - with $72.79$\% on time departures - than the other two airports. Looking at the standardized barplot, LGA airport appears to have fewer departure delay percentage than the other two airports.

### Exercise 7

```{r flights-avg-speed}
nycflights <- nycflights %>%
  mutate(avg_speed = (distance / air_time)*60)
```

### Exercise 8

```{r flights-avg-speed-scatterplot}
ggplot(data = nycflights, aes(x = distance, y = avg_speed)) +
  geom_point()
```

The data shows that there is a slight curvature between distances $0$ and $2000$ miles, and then it shows that beyond a distance of $2000$ miles, the data shows approximately linear. The relationship between distance and average speed appears to be non-linear with almost homoskedastic variation.

### Exercise 9

```{r arrival-vs-departure-scatterplot}
nycflight_3carriers <- nycflights %>%
  filter(carrier == "AA" | carrier == "DL" | carrier == "UA")

ggplot(data = nycflight_3carriers, 
       aes(x = dep_delay, y = arr_delay, colour = carrier)) +
  geom_point()
```

The scatterplot shows that the cutoff point for departure delays where you can still expect to get to your destination on time is around $50$ to$70$ minutes. You can verify this exactly by filtering the data points where arrival times are less than or equal to 5 minutes and pick the highest departure delay time. The code below shows that the exact cutoff point is $63$ minutes.

```{r on-time-cutoff}
nycflight_3carriers %>%
  filter(arr_delay <= 5) %>%
  select(dep_delay) %>%
arrange(desc(dep_delay))
```
